"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[4423],{"4423":function(A){A.exports=JSON.parse('{"version":3,"sources":["src/components/scroll-view/style/index.scss?tag=taro-scroll-view-core","src/components/scroll-view/scroll-view.tsx"],"names":["indexCss","easeOutScroll","from","to","callback","change","dur","sTime","Date","now","isLarger","linear","t","b","c","d","step","requestAnimationFrame","ScrollView","this","upperAndLower","debounce","_b","_this","el","offsetWidth","offsetHeight","scrollLeft","scrollTop","scrollHeight","scrollWidth","lowerThreshold","Number","upperThreshold","isNaN","scrollY","scrollX","onScrollToLower","emit","direction","onScrollToUpper","prototype","watchScrollLeft","newVal","_scrollLeft","scrollWithAnimation","pos","watchScrollTop","_scrollTop","watchScrollIntoView","_a","document","querySelector","concat","scrollIntoView","behavior","block","inline","handleScroll","e","CustomEvent","stopPropagation","onScroll","componentDidLoad","mpScrollTop","mpScrollLeft","render","cls","classNames","taro-scroll-view__scroll-x","taro-scroll-view__scroll-y","h","Host","class"],"mappings":"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","sourcesContent":["taro-scroll-view-core {\\n  display: block;\\n  width: 100%;\\n  -webkit-overflow-scrolling: auto;\\n\\n  &::-webkit-scrollbar {\\n    display: none;\\n  }\\n}\\n\\n.taro-scroll-view {\\n  &__scroll-x {\\n    overflow-x: scroll;\\n    overflow-y: hidden;\\n  }\\n\\n  &__scroll-y {\\n    overflow-x: hidden;\\n    overflow-y: scroll;\\n  }\\n}\\n","import { Component, h, ComponentInterface, Prop, Event, EventEmitter, Watch, Element, Host, Listen } from \'@stencil/core\'\\nimport classNames from \'classnames\'\\n\\nimport { debounce } from \'../../utils\'\\n\\nfunction easeOutScroll (from: number, to: number, callback) {\\n  if (from === to || typeof from !== \'number\') {\\n    return\\n  }\\n\\n  const change = to - from\\n  const dur = 500\\n  const sTime = Date.now()\\n  const isLarger = to >= from\\n\\n  function linear (t: number, b: number, c: number, d: number): number {\\n    return c * t / d + b\\n  }\\n\\n  function step () {\\n    from = linear(Date.now() - sTime, from, change, dur)\\n    if ((isLarger && from >= to) || (!isLarger && to >= from)) {\\n      callback(to)\\n      return\\n    }\\n    callback(from)\\n    requestAnimationFrame(step)\\n  }\\n\\n  step()\\n}\\n\\n@Component({\\n  tag: \'taro-scroll-view-core\',\\n  styleUrl: \'./style/index.scss\'\\n})\\nexport class ScrollView implements ComponentInterface {\\n  private _scrollLeft: number\\n  private _scrollTop: number\\n\\n  @Element() el: HTMLElement\\n\\n  @Prop() scrollX = false\\n  @Prop() scrollY = false\\n  @Prop() upperThreshold: number | string = 50\\n  @Prop() lowerThreshold: number | string = 50\\n  @Prop({ attribute: \'scroll-top\', reflect: true }) mpScrollTop: number | string\\n  @Prop({ attribute: \'scroll-left\', reflect: true }) mpScrollLeft: number | string\\n  @Prop({ attribute: \'scroll-into-view\', reflect: true }) mpScrollIntoView: string\\n  @Prop() scrollWithAnimation = false\\n\\n  @Event({\\n    eventName: \'scroll\',\\n    bubbles: false\\n  })\\n  onScroll: EventEmitter\\n\\n  @Event({\\n    eventName: \'scrolltoupper\',\\n    bubbles: false\\n  })\\n  onScrollToUpper: EventEmitter\\n\\n  @Event({\\n    eventName: \'scrolltolower\',\\n    bubbles: false\\n  })\\n  onScrollToLower: EventEmitter\\n\\n  @Watch(\'mpScrollLeft\')\\n  watchScrollLeft (newVal) {\\n    const scrollLeft = Number(newVal)\\n    if (\\n      this.scrollX &&\\n      !isNaN(scrollLeft) &&\\n      scrollLeft !== this._scrollLeft\\n    ) {\\n      if (this.scrollWithAnimation) {\\n        easeOutScroll(this._scrollLeft, scrollLeft, pos => (this.el.scrollLeft = pos))\\n      } else {\\n        this.el.scrollLeft = scrollLeft\\n      }\\n      this._scrollLeft = scrollLeft\\n    }\\n  }\\n\\n  @Watch(\'mpScrollTop\')\\n  watchScrollTop (newVal) {\\n    const scrollTop = Number(newVal)\\n    if (\\n      this.scrollY &&\\n      !isNaN(scrollTop) &&\\n      scrollTop !== this._scrollTop\\n    ) {\\n      if (this.scrollWithAnimation) {\\n        easeOutScroll(this._scrollTop, scrollTop, pos => (this.el.scrollTop = pos))\\n      } else {\\n        this.el.scrollTop = scrollTop\\n      }\\n      this._scrollTop = scrollTop\\n    }\\n  }\\n\\n  @Watch(\'mpScrollIntoView\')\\n  watchScrollIntoView (newVal) {\\n    if (typeof newVal === \'string\' && newVal) {\\n      document.querySelector(`#${newVal}`)?.scrollIntoView({\\n        behavior: \'smooth\',\\n        block: \'center\',\\n        inline: \'start\'\\n      })\\n    }\\n  }\\n\\n  @Listen(\'scroll\', { capture: true })\\n  handleScroll (e: Event) {\\n    if (e instanceof CustomEvent) return\\n    e.stopPropagation()\\n\\n    const {\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    } = this.el\\n    this._scrollLeft = scrollLeft\\n    this._scrollTop = scrollTop\\n\\n    this.upperAndLower()\\n\\n    this.onScroll.emit({\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    })\\n  }\\n\\n  componentDidLoad () {\\n    const {\\n      scrollY,\\n      scrollX,\\n      scrollWithAnimation\\n    } = this\\n\\n    const scrollTop = Number(this.mpScrollTop)\\n    const scrollLeft = Number(this.mpScrollLeft)\\n\\n    if (scrollY && !isNaN(scrollTop)) {\\n      if (scrollWithAnimation) {\\n        easeOutScroll(0, scrollTop, pos => (this.el.scrollTop = pos))\\n      } else {\\n        this.el.scrollTop = scrollTop\\n      }\\n      this._scrollTop = scrollTop\\n    }\\n\\n    if (scrollX && !isNaN(scrollLeft)) {\\n      if (scrollWithAnimation) {\\n        easeOutScroll(0, scrollLeft, pos => (this.el.scrollLeft = pos))\\n      } else {\\n        this.el.scrollLeft = scrollLeft\\n      }\\n      this._scrollLeft = scrollLeft\\n    }\\n  }\\n\\n  upperAndLower = debounce(() => {\\n    const {\\n      offsetWidth,\\n      offsetHeight,\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    } = this.el\\n\\n    const lowerThreshold = Number(this.lowerThreshold)\\n    const upperThreshold = Number(this.upperThreshold)\\n\\n    if (\\n      !isNaN(lowerThreshold) &&\\n      ((this.scrollY && offsetHeight + scrollTop + lowerThreshold >= scrollHeight) ||\\n      (this.scrollX && offsetWidth + scrollLeft + lowerThreshold >= scrollWidth))\\n    ) {\\n      this.onScrollToLower.emit({\\n        direction: this.scrollX ? \'right\' : (this.scrollY ? \'bottom\' : \'\')\\n      })\\n    }\\n\\n    if (\\n      !isNaN(upperThreshold) &&\\n      ((this.scrollY && scrollTop <= upperThreshold) ||\\n      (this.scrollX && scrollLeft <= upperThreshold))\\n    ) {\\n      this.onScrollToUpper.emit({\\n        direction: this.scrollX ? \'left\' : (this.scrollY ? \'top\' : \'\')\\n      })\\n    }\\n  }, 200)\\n\\n  render () {\\n    const {\\n      scrollX,\\n      scrollY\\n    } = this\\n\\n    const cls = classNames({\\n      \'taro-scroll-view__scroll-x\': scrollX,\\n      \'taro-scroll-view__scroll-y\': scrollY\\n    })\\n    return (\\n      <Host class={cls}>\\n        <slot />\\n      </Host>\\n    )\\n  }\\n}\\n"]}')}}]);